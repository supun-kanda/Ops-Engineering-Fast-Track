<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: dao/mongodb.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: dao/mongodb.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var itemDB,
mongo = require('mongodb'),
mongoClient = mongo.MongoClient;
//Wat is DAO??
mongoClient.connect('mongodb://localhost:27017/pos', (err,client) => {
    if(err) throw err; //handle error
    itemDB = client.db('pos').collection('items');
    console.log('Connected to DB-items');
});

/**
 * @param {String} userid userid of your username
 * @returns {Promise} fetched array will be included in resolve. Error will include in reject
 * @example
 * getAllItems(3).then(item => //the same itemObject inserted with property _id added)
 */
function getAllItems(userid){
    return new Promise((resolve,reject) => {
        itemDB.find( {userid: {$eq:userid}} ).toArray((err,result) => {
            if(err) reject(err);
            resolve(result);
        });
    });
}

/**
 * @param {Object} itemObject which includes name, userid 
 * @returns {Promise} fetched array will be included in resolve. Error will include in reject
 * @example
 * insertOne({userid:2,name:'Jhon'}).then(item => //the same itemObject inserted with property _id added)
 */
function insertOne(item){
    return new Promise((resolve,reject) => {
        itemDB.insertOne(item, err => {
            if(err) reject(err);
            resolve(item);
        });
    });
}

/**
 * @param {Array} itemids you want to delete from DB
 * @returns {Promise} fetched array will be included in resolve. Error will include in reject
 * @example
 * deleteMany(['5cae241f56e2df3ef3e4d76f','5cae243f56e2df3ef3e4d771']).then(n=>//deleted n numberof items)
 */
function deleteMany(ids){
    var objectIDs = ids.map(id => new mongo.ObjectID(id));
    return new Promise((resolve,reject) => {
        itemDB.deleteMany({_id:{'$in':objectIDs}}, (err,result) => {
            if(err) reject(err);
            resolve(result.result.n);
        });
    });
}

module.exports = {getAllItems, insertOne, deleteMany};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#clearCookie">clearCookie</a></li><li><a href="global.html#deleteItem">deleteItem</a></li><li><a href="global.html#deleteMany">deleteMany</a></li><li><a href="global.html#getAllItems">getAllItems</a></li><li><a href="global.html#getUser">getUser</a></li><li><a href="global.html#insertItem">insertItem</a></li><li><a href="global.html#insertOne">insertOne</a></li><li><a href="global.html#insertUser">insertUser</a></li><li><a href="global.html#mainPage">mainPage</a></li><li><a href="global.html#signinPage">signinPage</a></li><li><a href="global.html#signupPage">signupPage</a></li><li><a href="global.html#validateUser">validateUser</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Apr 11 2019 02:44:30 GMT+0530 (+0530)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
